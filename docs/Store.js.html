<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Store.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Store.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
A class representing a store of Item`s in a Room.
  @class
  @default
  @exports Store
*/
export default class Store {
  /**
  Create a store.
  @constructor
  @param {Object} options - The options object.
  @param {Room} options.room - The associated room.
  @param {Object} options.bonuses - The bonuses object.
  @param {number} options.bonuses.coins - The number of coins.
  @param {number} options.bonuses.crystal - The number of crystals.
*/
  constructor({ room, bonuses } = {}) {
    this.coins = bonuses.coins;
    this.crystal = bonuses.crystal;
    this.room = room;
  }

/**
  Opens the store.
  @function
  @param {Room} room - The associated room.
*/

  open(room) {
    this.items = room.subElements;
    this.currentRoom = room;
    this.render();
  }

/**
  Buys an item from the store.  
  @function
  @param {Item} item - The item to buy.
*/

  buyItem(item) {
    const itemPrice = item.basePrice;
    if (item.currentVersionIndex &lt; item.versions.length - 1 &amp;&amp; this.coins >= itemPrice) {
      item.upgrade();
      this.coins -= itemPrice;
      this.updateRender(item);
      this.render();

      const moneyUpdateEvent = new CustomEvent('moneyUpdate', { detail: { coins: this.coins, crystal: this.crystal } });
      document.dispatchEvent(moneyUpdateEvent);
    }
  }
/**
  Renders the store.
  @function
*/
  render() {
    if (!this.currentRoom) {
      console.error("No room is associated with the store.");
      return;
    }

    this.currentRoom.items.forEach((item) => {
      const itemDiv = item.itemDiv;
      if (item.currentVersionIndex &lt; item.versions.length - 1) {
        const buyButton = document.createElement("button");
        buyButton.style.backgroundColor = 'transparent';
        buyButton.style.color = 'grey';
        buyButton.style.border = 'solid white 1px';
        buyButton.textContent = `${item.basePrice} ü™ô`;
        buyButton.addEventListener("click", () => {
          this.buyItem(item);
        });
        itemDiv.appendChild(buyButton);
      }
    });
  }

/**
  Updates the store render.
  @function
*/

  updateRender() {
    this.currentRoom.render()
  }

/**
  Closes the store.
  @function
*/

  close() {
    this.currentRoom.items.forEach(item => {
      const buyButtons = item.itemDiv.querySelectorAll("button");
      buyButtons.forEach((button) => button.remove());
    })
    this.currentRoom = null;
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Item.html">Item</a></li><li><a href="module-Room.html">Room</a></li><li><a href="module-Store.html">Store</a></li></ul><h3>Classes</h3><ul><li><a href="module-Room_subElements.html">subElements</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Wed Apr 12 2023 09:32:50 GMT+0300 (–∑–∞ —Å—Ö—ñ–¥–Ω–æ—î–≤—Ä–æ–ø–µ–π—Å—å–∫–∏–º –ª—ñ—Ç–Ω—ñ–º —á–∞—Å–æ–º)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
